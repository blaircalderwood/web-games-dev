<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: menuHandling</title>

    <script src="../scripts/prettify/prettify.js"> </script>
    <script src="../scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="../styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="../styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: menuHandling</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var hostTimer, playerName, hostList, playerTeam;

/** Accessed via the on screen 'Host Game' and 'Join Game' buttons. The function sends the user's chosen name to the server to ensure it is available for use
 *
 * @param hosting - boolean which is set to true if the 'Host Game' button has been pressed
 */

function submitName(hosting) {

    playerName = $("#nameInput").val();

    if (hosting) getAjax("https://webgamesdev-blaircalderwood.c9.io/saveName?name=" + playerName, hostWait);
    else getAjax("https://webgamesdev-blaircalderwood.c9.io/checkName?name=" + playerName, checkName);

}

/** Called if the user wishes to join a game. Creates a list of all of the available hosts and displays on screen.
 *
 * @param availability - Recieved from the server. Contains a list of available hosts if chosen name is available and returns false if unavailable
 */

function checkName(availability) {

    var playerList = $("#playerList");
    playerList.html("");
    var newHTML = "";

    if (availability !== "false") {

        availability = JSON.parse(availability);

        if (availability.length == 0) {
            playerList.html("&lt;h2 style='color: white;'>&lt;b>There are no games available. Please consider hosting one.&lt;/b>&lt;/h2>");
        }
        console.log(availability);
        hostList = availability;

        newHTML = "&lt;ul style='list-style-type: none'>";
        for (var i = 0; i &lt; availability.length; i++) {

            console.log(availability[i]);
            newHTML += "&lt;li>&lt;button class='hostList' data-index='" + i + "' onclick='selectHost(this)'>" + availability[i] + "&lt;/button>&lt;/li>";

        }

        newHTML += "&lt;/ul>";
        playerList.append(newHTML);

    }

    else {
        playerList.html("&lt;h1 style='color: white;'>&lt;b>Name is unavailable. Please select another.&lt;/b>&lt;/h1>");
    }

}

/** Called after a host is selected from the list. Informs the server of this selection and starts the game
 *
 * @param listItem - Chosen host
 */

function selectHost(listItem) {

    console.log($(listItem).data('index'));

    console.log(hostList[$(listItem).data('index')]);

    getAjax("https://webgamesdev-blaircalderwood.c9.io/selectHost?name=" + playerName + "&amp;selectedName=" + hostList[$(listItem).data('index')], playGame);

}

/** Set the team colour and play the game
 *
 * @param data - confirmation of connection to host recieved from server
 */

function playGame(data) {

    playerTeam = "red";
    console.log(JSON.parse(data));
    startGame();

}

/** If the player has chosen to be a host inform them that the game will start once a player joins then periodically check the server for a joined player
 *
 * @param availability - Received from the server. Returns false if name is unavailable
 */

function hostWait(availability) {

    var playerList = $("#playerList");
    if (availability !== "false") {

        playerList.html("&lt;h1 style='color: white;'>&lt;b>Game created. Waiting for player to join&lt;/b>&lt;/h1>");

        hostTimer = setInterval(function () {

            getAjax("https://webgamesdev-blaircalderwood.c9.io/checkHost?name=" + playerName, playerJoined);

        }, 500)
    }
    else playerList.html("&lt;h1 style='color: white;'>&lt;b>Name is unavailable. Please select another.&lt;/b>&lt;/h1>");

}

/** Play the game once another player joins the host
 *
 * @param data - Received from the server. Confirmation that another player has joined.
 */

function playerJoined(data) {

    if (data !== "false") {

        playerTeam = "blue";
        console.log(data);
        clearInterval(hostTimer);

        startGame();

    }

}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#checkName">checkName</a></li><li><a href="global.html#hostWait">hostWait</a></li><li><a href="global.html#playerJoined">playerJoined</a></li><li><a href="global.html#playGame">playGame</a></li><li><a href="global.html#selectHost">selectHost</a></li><li><a href="global.html#submitName">submitName</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-beta3</a> on Fri May 01 2015 19:12:44 GMT+0100 (GMT Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="../scripts/linenumber.js"> </script>
</body>
</html>
